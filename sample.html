<html lang="en">
<head>
  <title>Hls.js WebOs demo</title>
</head>

<body>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script src="https://wiinvent.tv/sdk/tv/wii-sdk-1.6.3.js"></script>

<h1>Hls.js demo</h1>
<div id="videoId">
  <video id="video" controls></video>
</div>

<script>
  var video = document.getElementById('video');
  var wiiSdk = []

  if (Hls.isSupported()) {
    var hls = new Hls({
      debug: true,
    });
    wiiSdk = new WI.InstreamSdk({
      env: WI.Environment.SANDBOX,
      tenantId: 14,
      deviceType: WI.DeviceType.TV,
      domId: "videoId",
      channelId: "2",
      streamId: "1999",
      partnerSkipOffset: 6,
      vastLoadTimeout: 10,
      mediaLoadTimeout: 10,
      bufferingVideoTimeout: 15,
      alwaysCustomSkip: true,
      isAutoRequestFocus: false,
      bitrate: 1024,
      skipText: "Skip ads after {0} seconds",
      skippableText: "Skip ads"
    })
    hls.loadSource('https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8');
    hls.attachMedia(video);
    hls.on(Hls.Events.MEDIA_ATTACHED, function () {
      video.muted = true;
      wiiSdk.start()
    });
  } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
    wiiSdk = new WI.InstreamSdk({
      env: WI.Environment.SANDBOX,
      tenantId: 14,
      deviceType: WI.DeviceType.TV,
      domId: "videoId",
      channelId: "2",
      streamId: "1999",
      partnerSkipOffset: 6,
      vastLoadTimeout: 10,
      mediaLoadTimeout: 10,
      bufferingVideoTimeout: 15,
      alwaysCustomSkip: true,
      isAutoRequestFocus: false,
      bitrate: 1024,
      skipText: "Skip ads after {0} seconds",
      skippableText: "Skip ads"
    })
    video.src = 'https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8';
    video.addEventListener('canplay', function () {
      wiiSdk.start()
    });
  }

  window.addEventListener("message", function (e) {
    if (
      [
        "REQUEST",
        "LOADED",
        "START",
        "PAUSED",
        "RESUMED",
        "ERROR",
        "PLAYER_ERROR",
        "CLICK",
        "IMPRESSION",
        "SKIPPED",
        "COMPLETE",
        "DESTROY",
        "FULLSCREEN",
        "END",
        "All_ADS_COMPLETE",
      ].includes(e.data.type)) {
      console.log('mmmm', e)
    }
  })
</script>
</body>
</html>